using System.Collections.Generic;
using System.Linq;

public static class VulnerabilityPairings
{
    private static Dictionary<AttackTypes, List<DefenseTypes>> _vulnerabilityPairs;

    static VulnerabilityPairings()
    {
        _vulnerabilityPairs = new Dictionary<AttackTypes, List<DefenseTypes>>
        {
            { AttackTypes.Injection,             new List<DefenseTypes> { DefenseTypes.Sanitize_Input } },
            { AttackTypes.Credential_Stuffing,   new List<DefenseTypes> { DefenseTypes.Two_Factor_Auth } },
            { AttackTypes.Package_Sniffing,      new List<DefenseTypes> { DefenseTypes.Firewall } },
            { AttackTypes.Hostile_XML,           new List<DefenseTypes> { DefenseTypes.Sanitize_Input, DefenseTypes.Firewall } },
            { AttackTypes.Bypass_Access_Control, new List<DefenseTypes> { DefenseTypes.Log_Failure} }
        };
    }

    public static bool IsVulnerable(AttackTypes attack, DefenseTypes defense)
    {
        return _vulnerabilityPairs[attack].Contains(defense);
    }
}

